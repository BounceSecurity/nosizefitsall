rules:
  - id: ex2_security_decorators-update
    patterns:
      - pattern: |
          def $FUNC(...):
            ...
      - focus-metavariable:
          - $FUNC
      - pattern-not-inside: |
          @require_update_purrrmission
          def $FUNC(...):
            ...
      - pattern-inside: |
          class SensitiveFunctions:
            ...
    message: Function "$FUNC" is missing the authorization decorator
    languages:
      - python
    severity: WARNING
